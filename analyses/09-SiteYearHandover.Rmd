---
title: "9-SiteYearHandover"
author: "Galina M. JÃ¶nsson"
date: "15/09/2021"
output: html_document
---

## All sites and site:year combinations
```{r site-numbers-A-urticae, message=FALSE, warning=FALSE, echo=FALSE}
occDetdata <- read.csv("../data/formattedData/occDetdata_merged_2020-04-07.csv", 
                       header=T, na.strings=c("","NA")) 
spp_vis <- read.csv("../data/formattedData/spp_vis_merged_2020-04-07.csv", 
                    header=T, na.strings=c("","NA"))


taxa_names <- c('Aglais.urticae',
                'Carterocephalus.palaemon',
                'Erebia.aethiops',
                'Erebia.epiphron',
                'Limenitis.camilla',
                'Lycaena.phlaeas',
                'Melitaea.athalia',
                'Pararge.aegeria',
                'Pieris.rapae',
                'Polygonia.c.album',
                'Polyommatus.bellargus',
                'Thecla.betulae') 


source("./function-DT.overlap.R")

interval <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)

A_urticae <- DT.overlap(taxon_name = 'Aglais.urticae',
                         occDetdata = occDetdata,
                         spp_vis = spp_vis,
                         modeltype = "mixlistlength",
                         minTP = 61, 
                         maxTP = 76,
                         TPinterval = interval)


temp <- as.data.frame(matrix(ncol=5,nrow=3*16))
names(temp) <- c("TPbin", "DTcomp", "sites", "site_TPs", "TPs")
temp$TPbin <-  rep(interval, each= 3)
temp$DTcomp <-  rep(c("1-2", "1-3", "2-3"), times= 16)
      
count <- 1
for (i in interval) {
  temp[count:(count+2), 3:5] <- A_urticae[[i]]$overlap[1:3,1:3]
  count <- count+3
}

temp <- subset(temp, DTcomp == "1-3")

# Plot
plot(temp$TPbin, temp$site_TPs,
     main = "Overlapping BNM-NHC records 1960-1975 \n Small Tortoisshell (Aglais urticae)",
     xlab = "Year bins",
     ylab= "Site:Time Period Combinations")
```


